; PlatformIO Project Configuration File
;
; ESP-NOW Transmitter (Modular)
; Hardware: Olimex ESP32-POE-ISO (WROVER)
;
; Features:
;  - ESP-NOW transmitter protocol
;  - Ethernet connectivity (W5500)
;  - MQTT telemetry publishing
;  - HTTP OTA firmware updates
;  - NTP time synchronization

[platformio]
default_envs = esp32-poe-iso

[env:esp32-poe-iso]
platform = espressif32@6.5.0
board = esp32-poe-iso
framework = arduino

; Build flags
build_flags = 
    -std=gnu++17
    -I../../esp32common/espnow_transmitter
    -I../../esp32common
    -I$PROJECT_INCLUDE_DIR
    -DCORE_DEBUG_LEVEL=3
    -DBOARD_HAS_PSRAM
    -mfix-esp32-psram-cache-issue
    -DARDUINO_ARCH_ESP32
    ; Logging control - set compile-time log level
    ; LOG_NONE=0, LOG_ERROR=1, LOG_WARN=2, LOG_INFO=3, LOG_DEBUG=4, LOG_TRACE=5
    -D COMPILE_LOG_LEVEL=LOG_INFO    ; Default: INFO and above (change to LOG_DEBUG for verbose)

; Library dependencies
lib_deps = 
    ; MQTT client for telemetry
    knolleary/PubSubClient @ ^2.8
    
    ; JSON serialization
    bblanchon/ArduinoJson @ ^6.21.3
    
    ; Async web server (for OTA)
    https://github.com/me-no-dev/ESPAsyncWebServer.git
    https://github.com/me-no-dev/AsyncTCP.git

; Ignore libraries that conflict
lib_ignore = 
    WebServer

; Extra library directories (for local libraries)
lib_extra_dirs = 
    ../../esp32common

; Upload settings
upload_speed = 921600
monitor_speed = 115200
monitor_filters = esp32_exception_decoder

; Partition scheme (ensure space for OTA)
board_build.partitions = default.csv

; Flash settings
board_build.flash_mode = qio
board_build.f_flash = 80000000L
board_build.f_cpu = 240000000L

; PSRAM settings (WROVER variant)
board_build.arduino.memory_type = qio_qspi

; Optimization
build_type = release
